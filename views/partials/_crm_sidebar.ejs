<!-- القائمة الجانبية لنظام CRM -->
<div class="crm-sidebar">
  <ul class="crm-sidebar-nav">
    <li>
      <a href="/crm" class="<%= typeof isDashboardPage !== 'undefined' && isDashboardPage ? 'active' : '' %>">
        <i class="fas fa-tachometer-alt"></i>
        <span>لوحة التحكم</span>
      </a>
    </li>
    <li>
      <a href="/crm/contacts" class="<%= typeof isContactsPage !== 'undefined' && isContactsPage ? 'active' : '' %>">
        <i class="fas fa-address-book"></i>
        <span>جهات الاتصال</span>
      </a>
    </li>
    <li>
      <a href="/crm/conversations/ajax" class="<%= typeof isConversationsPage !== 'undefined' && isConversationsPage ? 'active' : '' %>">
        <i class="fas fa-comments"></i>
        <span>المحادثات</span>
      </a>
    </li>
    <li>
      <a href="/crm/stats" class="<%= typeof isStatsPage !== 'undefined' && isStatsPage ? 'active' : '' %>">
        <i class="fas fa-chart-bar"></i>
        <span>الإحصائيات</span>
      </a>
    </li>
    <!-- يمكن إضافة روابط أخرى هنا في المستقبل -->
    <li class="mt-4">
      <a href="/" class="text-muted">
        <i class="fas fa-arrow-right"></i>
        <span>العودة للرئيسية</span>
      </a>
    </li>
  </ul>
</div>

<!-- سكريبت لتحسين سلوك القائمة الجانبية على الجوال -->
<script>
    document.addEventListener('DOMContentLoaded', () => {
        const crmSidebar = document.querySelector('.crm-sidebar');
        const crmSidebarToggler = document.getElementById('crmSidebarToggler');
        let crmSidebarOverlay = document.querySelector('.crm-sidebar-overlay');

        // إنشاء Overlay إذا لم يكن موجودًا
        if (!crmSidebarOverlay) {
            crmSidebarOverlay = document.createElement('div');
            crmSidebarOverlay.className = 'crm-sidebar-overlay';
            document.body.appendChild(crmSidebarOverlay);
        }

        if (crmSidebarToggler && crmSidebar && crmSidebarOverlay) {
            crmSidebarToggler.addEventListener('click', (event) => {
                event.stopPropagation(); // منع الانتشار إلى مستمع الـ body
                crmSidebar.classList.toggle('open');
                crmSidebarOverlay.classList.toggle('show');
            });

            crmSidebarOverlay.addEventListener('click', () => {
                crmSidebar.classList.remove('open');
                crmSidebarOverlay.classList.remove('show');
            });
            
            // إغلاق القائمة عند النقر خارجها (على الـ body)
            // document.body.addEventListener('click', (event) => {
            //     if (crmSidebar.classList.contains('open') && 
            //         !crmSidebar.contains(event.target) && 
            //         event.target !== crmSidebarToggler) {
            //         crmSidebar.classList.remove('open');
            //         crmSidebarOverlay.classList.remove('show');
            //     }
            // });
        }
    });
</script>
