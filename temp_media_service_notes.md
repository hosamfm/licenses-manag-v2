# ملاحظات حول إنشاء وتعديل خدمة الوسائط

## الملفات التي تحتاج للتعديل
1. إنشاء: `services/mediaService.js` - خدمة جديدة للوسائط
2. تعديل: `controllers/whatsappMediaController.js` - نقل المنطق المشترك إلى خدمة الوسائط
3. تعديل: `controllers/conversationController.js` - استخدام خدمة الوسائط بدلاً من المنطق المكرر
4. تعديل: `controllers/metaWhatsappWebhookController.js` - استخدام خدمة الوسائط بدلاً من المنطق المباشر

## المهام الرئيسية
1. استخراج المنطق المشترك لمعالجة الوسائط وتحويله إلى دوال في خدمة الوسائط
2. تأكد من أن جميع المسارات (الواردة/الصادرة/HTTP/Socket) تستخدم نفس خدمة الوسائط
3. إضافة تعليقات واضحة ودقيقة
4. إزالة الكود القديم بالكامل دون ترك تعليقات

## الوظائف المطلوبة في خدمة الوسائط
1. البحث عن الوسائط المرتبطة برسالة
2. ربط الوسائط بالرسائل
3. معالجة البيانات لعرض الوسائط في الواجهة
4. إنشاء/تحديث/استرجاع سجلات الوسائط

## المسارات التي يجب توحيدها
1. الرسائل الواردة (من Webhook)
2. الرسائل الصادرة (من التطبيق)
3. الرسائل التي تأتي عبر HTTP
4. الرسائل التي تأتي عبر Socket
