# خطة إصلاح مشكلة إرسال المرفقات في واتساب

## المشكلة
1. عند إرسال ملفات مرفقة عبر واتساب، تظهر أخطاء مثل:
   - `Invalid character in header content ["Content-Disposition"]`
   - مشكلة في إرسال الرسالة مع المرفق
   - أخطاء 404 و500 عند محاولة الوصول إلى محتوى الوسائط

## الأسباب المحتملة
1. مشكلة في معالجة أسماء الملفات، خاصة الأسماء العربية
2. مشكلة في ترميز النص المصاحب للمرفقات (caption)
3. مشكلة في دالة `set` في نموذج WhatsappMedia

## خطة الإصلاح (مبسطة)

### الخطوة 1: إصلاح نموذج WhatsappMedia.js
- [x] إزالة دالة `set` من حقل `fileName` التي تسبب مشاكل في ترميز أسماء الملفات

### الخطوة 2: تبسيط معالجة أسماء الملفات في MetaWhatsappService.js
- [x] تعديل دالة `uploadMediaToWhatsapp` لاستخدام أسماء ملفات بسيطة
- [x] إزالة `encodeURIComponent` من النص المصاحب (caption) في جميع دوال إرسال الوسائط

### الخطوة 3: تبسيط آلية تحميل الملفات في whatsappMediaController.js
- [x] تبسيط معالجة أسماء الملفات وإزالة التحويلات المعقدة

### الخطوة 4: اختبار التغييرات
- [ ] اختبار إرسال صورة مع نص
- [ ] اختبار إرسال مستند مع نص
- [ ] اختبار إرسال ملفات بأسماء عربية

## ملاحظات
- نريد تبسيط الكود قدر الإمكان
- عدم إضافة أي تحسينات إضافية
- التركيز فقط على إصلاح المشكلة الأساسية
